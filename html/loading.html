<!doctype html> <html lang="ko"> 
  <head>
     <meta charset="utf-8" /> 
     <meta name="viewport" content="width=device-width, initial-scale=1" /> 
     <title>loading</title> 
     <link rel="stylesheet" href="../css/loading.css" /> 
    </head>
     <body> <div class="wrap"> 
      <main class="phone" role="main"> 
      <section class="canvas"> 
        <!-- í…ìŠ¤íŠ¸ --> 
         <h2 class="loading-text">ê²°ê³¼ ë¶„ì„ ì¤‘<span class="dots">...</span></h2>
          <!-- ê°•ì•„ì§€ ì´ë¯¸ì§€ (3ê°œ) --> <div class="dog-icons">
             <img src="../image/mainDogs.png" alt="ê°•ì•„ì§€1"> 
            </div> </section> </main> </div>

<script>
  console.log("âœ… loading.html script ì‹¤í–‰ë¨");

  window.addEventListener("DOMContentLoaded", () => {
    console.log("âœ… DOMContentLoaded ì‹¤í–‰ë¨");
    // ğŸ”¹ 0.5ì´ˆ í›„ì— fetch ì‹œì‘ (í™”ë©´ì´ ë¨¼ì € ë Œë”ë§ë˜ê²Œ)
    setTimeout(sendResult, 500);
  });

  async function sendResult() {
    const data = {
      q1: sessionStorage.getItem("Q1"),
      q2: sessionStorage.getItem("Q2"),
      q3: sessionStorage.getItem("Q3"),
      q4: sessionStorage.getItem("Q4")
    };

    console.log("ğŸ“¦ ì „ì†¡í•  ë°ì´í„°:", data);

    try {
      const res = await fetch("http://localhost:8080/api/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const result = await res.text();
      console.log("âœ… ì„œë²„ ê²°ê³¼:", result);

      // ğŸ”¹ ìµœì†Œ 1.5ì´ˆ ë™ì•ˆ ë¡œë”© ìœ ì§€
      await new Promise(resolve => setTimeout(resolve, 1500));

      // ğŸ”¹ ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
      window.location.href = `${result}.html`;

    } catch (error) {
      console.error("âŒ ì„œë²„ ìš”ì²­ ì‹¤íŒ¨:", error);
      alert("ì„œë²„ ì—°ê²°ì— ë¬¸ì œê°€ ìˆì–´ìš” ğŸ˜¢");
    }
  }
</script>
